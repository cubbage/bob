<!DOCTYPE html>
<html>

<head>
  <title>Semantic Display Test</title>
  <style>
    .semantic-structure {
      display: inline-block;
      margin: 2px 4px;
      padding: 4px 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
      background-color: #f8f9fa;
    }

    .preview {
      border: 1px solid #ccc;
      padding: 1rem;
      margin: 1rem 0;
      min-height: 100px;
      white-space: pre-wrap;
    }
  </style>
</head>

<body>
  <h1>Semantic Structure Display Test</h1>

  <div>
    <h3>Input Text:</h3>
    <textarea id="input" rows="5"
      cols="80">⦕KEY POINT: Detective fiction highlights the brilliance of the mind while Horror emphasizes its flaws.⟢Detective celebrates mind's power; Horror exposes its flaws⟣⦖</textarea>
    <button onclick="processText()">Process Text</button>
  </div>

  <div>
    <h3>Output:</h3>
    <div id="preview" class="preview"></div>
  </div>

  <script>
    function processText() {
      const text = document.getElementById('input').value;
      const preview = document.getElementById('preview');

      // Simple semantic structure detection
      const regex = /⦕(.*?)⟢(.*?)⟣⦖/g;
      let match;
      let processedText = text;

      while ((match = regex.exec(text)) !== null) {
        const fullMatch = match[0];
        const fragment = match[1];
        const summary = match[2];

        // Parse components
        let label = '';
        let sourceText = fragment;
        const colonIndex = fragment.indexOf(':');
        if (colonIndex !== -1) {
          label = fragment.substring(0, colonIndex).trim();
          sourceText = fragment.substring(colonIndex + 1).trim();
        }

        // Create semantic structure display
        const container = document.createElement('span');
        container.className = 'semantic-structure';

        if (label) {
          const labelSpan = document.createElement('span');
          labelSpan.textContent = label;
          labelSpan.style.fontWeight = 'bold';
          labelSpan.style.color = '#333';
          container.appendChild(labelSpan);

          const separator = document.createElement('span');
          separator.textContent = ': ';
          separator.style.color = '#666';
          container.appendChild(separator);
        }

        if (summary) {
          const summarySpan = document.createElement('span');
          summarySpan.textContent = summary;
          summarySpan.style.fontStyle = 'italic';
          summarySpan.style.color = '#666';
          container.appendChild(summarySpan);

          const separator = document.createElement('span');
          separator.textContent = ' | ';
          separator.style.color = '#999';
          container.appendChild(separator);
        }

        if (sourceText) {
          const sourceSpan = document.createElement('span');
          sourceSpan.textContent = sourceText;
          sourceSpan.style.color = '#333';
          container.appendChild(sourceSpan);
        }

        // Replace the match with the styled container
        processedText = processedText.replace(fullMatch, container.outerHTML);
      }

      preview.innerHTML = processedText;
    }

    // Auto-process on load
    processText();
  </script>
</body>

</html>